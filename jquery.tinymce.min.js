(function(d){var b,f,c,a=[],e=window;d.fn.tinymce=function(k){var i=this,j,l,o,m="";if(!i.length){return i}if(!k){return window.tinymce?tinymce.get(i[0].id):null}i.css("visibility","hidden");function n(){var q=[],p=0;if(!c){g();c=true}i.each(function(s,t){var r,v=t.id,u=k.oninit;if(!v){t.id=v=tinymce.DOM.uniqueId()}if(tinymce.get(v)){return}r=new tinymce.Editor(v,k,tinymce.EditorManager);q.push(r);r.on("init",function(){var w,x=u;i.css("visibility","");if(u){if(++p==q.length){if(typeof x==="string"){w=(x.indexOf(".")===-1)?null:tinymce.resolve(x.replace(/\.\w+$/,""));x=tinymce.resolve(x)}x.apply(w||tinymce,q)}}})});d.each(q,function(s,r){r.render()})}if(!e.tinymce&&!f&&(j=k.script_url)){f=1;l=j.substring(0,j.lastIndexOf("/"));if(j.indexOf(".min")!=-1){m=".min"}e.tinymce=e.tinyMCEPreInit||{base:l,suffix:m};if(j.indexOf("gzip")!=-1){o=k.language||"en";j=j+(/\?/.test(j)?"&":"?")+"js=true&core=true&suffix="+escape(m)+"&themes="+escape(k.theme||"modern")+"&plugins="+escape(k.plugins||"")+"&languages="+(o||"");if(!e.tinyMCE_GZ){e.tinyMCE_GZ={start:function(){function p(q){tinymce.ScriptLoader.markDone(tinymce.baseURI.toAbsolute(q))}p("langs/"+o+".js");p("themes/"+k.theme+"/theme"+m+".js");p("themes/"+k.theme+"/langs/"+o+".js");d.each(k.plugins.split(","),function(r,q){if(q){p("plugins/"+q+"/plugin"+m+".js");p("plugins/"+q+"/langs/"+o+".js")}})},end:function(){}}}}var h=document.createElement("script");h.type="text/javascript";h.onload=h.onreadystatechange=function(p){p=p||window.event;if(f!==2&&(p.type=="load"||/complete|loaded/.test(h.readyState))){tinymce.dom.Event.domLoaded=1;f=2;if(k.script_loaded){k.script_loaded()}n();d.each(a,function(q,r){r()})}};h.src=j;document.body.appendChild(h)}else{if(f===1){a.push(n)}else{n()}}return i};d.extend(d.expr[":"],{tinymce:function(i){var h;if(i.id&&"tinymce" in window){h=tinymce.get(i.id);if(h&&h.editorManager===tinymce){return true}}return false}});function g(){function j(m){if(m==="remove"){this.each(function(o,p){var n=i(p);if(n){n.remove()}})}this.find("span.mceEditor,div.mceEditor").each(function(o,p){var n=tinymce.get(p.id.replace(/_parent$/,""));if(n){n.remove()}})}function l(o){var n=this,m;if(o!=null){j.call(n);n.each(function(q,r){var p;if((p=tinymce.get(r.id))){p.setContent(o)}})}else{if(n.length>0){if((m=tinymce.get(n[0].id))){return m.getContent()}}}}function i(n){var m=null;if(n&&n.id&&e.tinymce){m=tinymce.get(n.id)}return m}function h(m){return !!((m)&&(m.length)&&(e.tinymce)&&(m.is(":tinymce")))}var k={};d.each(["text","html","val"],function(o,m){var p=k[m]=d.fn[m],n=(m==="text");d.fn[m]=function(t){var q=this;if(!h(q)){return p.apply(q,arguments)}if(t!==b){l.call(q.filter(":tinymce"),t);p.apply(q.not(":tinymce"),arguments);return q}var s="";var r=arguments;(n?q:q.eq(0)).each(function(v,w){var u=i(w);if(u){s+=n?u.getContent().replace(/<(?:"[^"]*"|'[^']*'|[^'">])*>/g,""):u.getContent({save:true})}else{s+=p.apply(d(w),r)}});return s}});d.each(["append","prepend"],function(o,n){var p=k[n]=d.fn[n],m=(n==="prepend");d.fn[n]=function(r){var q=this;if(!h(q)){return p.apply(q,arguments)}if(r!==b){if(typeof r==="string"){q.filter(":tinymce").each(function(t,u){var s=i(u);if(s){s.setContent(m?r+s.getContent():s.getContent()+r)}})}p.apply(q.not(":tinymce"),arguments);return q}}});d.each(["remove","replaceWith","replaceAll","empty"],function(n,m){var o=k[m]=d.fn[m];d.fn[m]=function(){j.call(this,m);return o.apply(this,arguments)}});k.attr=d.fn.attr;d.fn.attr=function(p,r){var n=this,o=arguments;if((!p)||(p!=="value")||(!h(n))){if(r!==b){return k.attr.apply(n,o)}return k.attr.apply(n,o)}if(r!==b){l.call(n.filter(":tinymce"),r);k.attr.apply(n.not(":tinymce"),o);return n}var q=n[0],m=i(q);return m?m.getContent({save:true}):k.attr.apply(d(q),o)}}})(jQuery);